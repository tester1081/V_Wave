<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>N3TData - Buy Data</title>
<style>
    /* Reset and Base Styles */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        -webkit-tap-highlight-color: transparent;
    }

    :root {
        --primary-color: #1e40af;
        --secondary-color: #3b82f6;
        --accent-color: #60a5fa;
        --light-bg: #f8fafc;
        --dark-text: #1e293b;
        --light-text: #f8fafc;
        --border-color: #e2e8f0;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --danger-color: #ef4444;
        --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --transition-speed: 0.3s;
        --mtn-color: #ffcc00;
        --glo-color: #00aa4f;
        --airtel-color: #ff0000;
        --mobile9-color: #006633;
        --grey-text: #64748b;
    }

    body {
        background-color: var(--light-bg);
        color: var(--dark-text);
        min-height: 100vh;
        position: relative;
        padding-bottom: 70px; /* Space for bottom nav */
    }

    /* Data Page Styles */
    .data-container {
        max-width: 500px;
        margin: 0 auto;
        padding: 0 1rem;
        padding-bottom: 80px;
    }

    /* Header Styles */
    .page-header {
        display: flex;
        align-items: center;
        padding: 1rem 0;
        margin-bottom: 1rem;
    }

    .back-button {
        background: none;
        border: none;
        font-size: 1.2rem;
        color: var(--dark-text);
        margin-right: 1rem;
        cursor: pointer;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .back-button:active {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .page-title {
        font-size: 1.2rem;
        font-weight: 600;
    }

    /* Network Slider */
    .network-slider-container {
        margin-bottom: 1.5rem;
        position: relative;
    }

    .slider-indicators {
        display: flex;
        justify-content: center;
        margin-bottom: 1rem;
    }

    .indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: #e2e8f0;
        margin: 0 4px;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .indicator.active {
        background-color: var(--primary-color);
        width: 20px;
        border-radius: 4px;
    }

    .network-slider {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
        padding: 0.5rem 0;
    }

    .network-slider::-webkit-scrollbar {
        display: none;
    }

    .network-option {
        flex: 0 0 100%;
        min-width: 100%;
        scroll-snap-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1.5rem;
        background-color: white;
        border-radius: 1rem;
        box-shadow: var(--card-shadow);
        transition: all 0.3s ease;
        cursor: pointer;
        user-select: none;
    }

    .network-option:hover {
        transform: translateY(-5px);
    }

    .network-option.selected {
        background-color: #eff6ff;
        border: 2px solid var(--secondary-color);
    }

    .network-image {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        position: relative;
        overflow: hidden;
    }

    .network-option.mtn .network-image {
        background-color: var(--mtn-color);
    }

    .network-option.glo .network-image {
        background-color: var(--glo-color);
    }

    .network-option.airtel .network-image {
        background-color: var(--airtel-color);
    }

    .network-option.mobile9 .network-image {
        background-color: var(--mobile9-color);
    }

    .network-logo {
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 2rem;
    }

    .network-name {
        font-weight: 600;
        font-size: 1.2rem;
    }

    .network-option.mtn .network-name {
        color: var(--mtn-color);
    }

    .network-option.glo .network-name {
        color: var(--glo-color);
    }

    .network-option.airtel .network-name {
        color: var(--airtel-color);
    }

    .network-option.mobile9 .network-name {
        color: var(--mobile9-color);
    }

    /* Form Styles */
    .form-container {
        background-color: white;
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--card-shadow);
        margin-bottom: 1.5rem;
    }

    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: #475569;
    }

    .input-wrapper {
        position: relative;
    }

    .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #94a3b8;
    }

    .form-input {
        width: 100%;
        padding: 0.75rem 1rem 0.75rem 2.5rem;
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        font-size: 1rem;
        transition: all var(--transition-speed);
    }

    .form-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    .form-input.network-display {
        background-color: #f1f5f9;
        font-weight: 600;
    }

    .form-select {
        width: 100%;
        padding: 0.75rem 1rem 0.75rem 2.5rem;
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        font-size: 1rem;
        transition: all var(--transition-speed);
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23555' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 1rem center;
        background-size: 1rem;
    }

    .form-select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    .form-select:disabled {
        background-color: #f1f5f9;
        cursor: not-allowed;
    }

    .btn {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 0.75rem;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: all var(--transition-speed);
        text-align: center;
    }

    .btn-primary {
        background-color: var(--primary-color);
        color: white;
    }

    .btn-primary:hover {
        background-color: #1e3a8a;
    }

    .btn-primary:active {
        transform: scale(0.98);
    }

    .btn-primary:disabled {
        background-color: #93c5fd;
        cursor: not-allowed;
    }

    .btn-block {
        display: block;
        width: 100%;
    }

    .btn-danger {
        background-color: var(--danger-color);
        color: white;
    }

    .btn-danger:hover {
        background-color: #b91c1c;
    }

    /* Bottom Navigation */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        display: flex;
        justify-content: space-around;
        padding: 0.75rem 0;
        box-shadow: 0 -1px 10px rgba(0, 0, 0, 0.05);
        z-index: 1000;
        border-top: 1px solid rgba(226, 232, 240, 0.8);
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: #64748b;
        text-decoration: none;
        font-size: 0.7rem;
        transition: color var(--transition-speed);
    }

    .nav-item.active {
        color: var(--primary-color);
    }

    .nav-icon {
        font-size: 1.2rem;
        margin-bottom: 0.25rem;
        position: relative;
    }

    .nav-item.active .nav-icon::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 50%;
        transform: translateX(-50%);
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background-color: var(--primary-color);
    }

    /* Toast Notification */
    .toast {
        position: fixed;
        right: -300px;
        top: 20px;
        padding: 12px 24px;
        background-color: #333;
        color: white;
        border-radius: 6px;
        font-size: 14px;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: right 0.3s ease-in-out;
        max-width: 280px;
        display: flex;
        align-items: center;
    }

    .toast.show {
        right: 20px;
    }

    .toast.success {
        background-color: var(--success-color);
    }

    .toast.error {
        background-color: var(--danger-color);
    }

    .toast-icon {
        margin-right: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Loading Spinner */
    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    .loading {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
        margin-right: 0.5rem;
    }

    /* Custom Modal */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-speed);
    }

    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .modal {
        background-color: white;
        border-radius: 1rem;
        box-shadow: var(--card-shadow);
        width: 90%;
        max-width: 400px;
        padding: 1.5rem;
        transform: translateY(-20px);
        transition: all var(--transition-speed);
    }

    .modal-overlay.active .modal {
        transform: translateY(0);
    }

    .modal-header {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--dark-text);
    }

    .modal-body {
        margin-bottom: 1.5rem;
        color: var(--grey-text);
    }

    .modal-body .summary-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.75rem;
    }

    .modal-body .summary-label {
        font-weight: 500;
        color: var(--dark-text);
    }

    .modal-body .summary-value {
        font-weight: 600;
        color: var(--dark-text);
    }

    .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
    }

    .modal-footer .btn {
        padding: 0.5rem 1rem;
    }
</style>
</head>
<body>
<div class="data-container">
    <div class="page-header">
        <button class="back-button" onclick="window.location.href='dashboard.html'">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5"></path>
                <path d="M12 19l-7-7 7-7"></path>
            </svg>
        </button>
        <h1 class="page-title">Buy Data</h1>
    </div>
    
    <div class="network-slider-container">
        <div class="slider-indicators" id="sliderIndicators">
            <div class="indicator active" data-index="0"></div>
            <div class="indicator" data-index="1"></div>
            <div class="indicator" data-index="2"></div>
            <div class="indicator" data-index="3"></div>
        </div>
        <div class="network-slider" id="networkSlider">
            <div class="network-option mtn" data-network="MTN" data-network-id="1">
                <div class="network-image">
                    <div class="network-logo">M</div>
                </div>
                <div class="network-name">MTN</div>
            </div>
            
            <div class="network-option airtel" data-network="AIRTEL" data-network-id="2">
                <div class="network-image">
                    <div class="network-logo">A</div>
                </div>
                <div class="network-name">Airtel</div>
            </div>
            
            <div class="network-option glo" data-network="GLO" data-network-id="3">
                <div class="network-image">
                    <div class="network-logo">G</div>
                </div>
                <div class="network-name">Glo</div>
            </div>
            
            <div class="network-option mobile9" data-network="9MOBILE" data-network-id="4">
                <div class="network-image">
                    <div class="network-logo">9</div>
                </div>
                <div class="network-name">9mobile</div>
            </div>
        </div>
    </div>
    
    <div class="form-container">
        <form id="dataForm">
            <div class="form-group">
                <label for="selectedNetwork" class="form-label">Selected Network</label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2v2"></path>
                        <path d="M12 20v2"></path>
                        <path d="m4.93 4.93 1.41 1.41"></path>
                        <path d="m17.66 17.66 1.41 1.41"></path>
                        <path d="M2 12h2"></path>
                        <path d="M20 12h2"></path>
                        <path d="m6.34 17.66-1.41 1.41"></path>
                        <path d="m19.07 4.93-1.41 1.41"></path>
                    </svg>
                    <input type="text" id="selectedNetwork" class="form-input network-display" readonly placeholder="Select a network above">
                </div>
            </div>
            
            <div class="form-group">
                <label for="planType" class="form-label">Plan Type</label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                        <line x1="7" y1="7" x2="7.01" y2="7"></line>
                    </svg>
                    <select id="planType" class="form-select" disabled>
                        <option value="" selected disabled>Select Plan Type</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label for="dataPlan" class="form-label">Data Plan</label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 12.55a11 11 0 0 1 14.08 0"></path>
                        <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                        <line x1="12" y1="20" x2="12.01" y2="20"></line>
                    </svg>
                    <select id="dataPlan" class="form-select" disabled>
                        <option value="" selected disabled>Select Data Plan</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="phoneNumber" class="form-label">Phone Number</label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                    </svg>
                    <input type="text" id="phoneNumber" class="form-input" placeholder="Enter 11-digit phone number" maxlength="11">
                </div>
            </div>

            <button type="submit" id="submitButton" class="btn btn-primary btn-block" disabled>
                <span id="buttonText">Buy Now</span>
            </button>
        </form>
    </div>
</div>

<!-- Toast Notification -->
<div id="toast" class="toast">
    <div class="toast-icon" id="toastIcon"></div>
    <div id="toastMessage"></div>
</div>

<!-- Custom Modal -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal">
        <div class="modal-header">Confirm Purchase</div>
        <div class="modal-body" id="modalBody">
            <!-- Purchase details will be inserted here -->
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" id="confirmPurchase">Confirm</button>
            <button class="btn btn-danger" id="cancelPurchase">Cancel</button>
        </div>
    </div>
</div>


<!-- Bottom Navigation -->
<div class="bottom-nav">
    <a href="dashboard.html" class="nav-item">
        <div class="nav-icon"><i class="fas fa-home"></i></div>
        <div class="nav-label">Home</div>
    </a>
    <a href="games.html" class="nav-item">
        <div class="nav-icon"><i class="fas fa-gamepad"></i></div>
        <div class="nav-label">Game TOP UP</div>
    </a>
    <a href="#" class="nav-item">
        <div class="nav-icon"><i class="fas fa-shopping-bag"></i></div>
        <div class="nav-label">Store</div>
    
    <a href="profile.html" class="nav-item">
        <div class="nav-icon"><i class="fas fa-user"></i></div>
        <div class="nav-label">Profile</div>
    </a>
</div>

<script>
    // API credentials
    const ACCESS_TOKEN = "3cfedeade5a3a75342ce13245ac4de9e9b3ca0aaf86a05a5aa1447c12d7d";

    // Data plans by network and type
    const DATA_PLANS = {
        "MTN": {
            "SME": [
                { id: 1, name: "500MB", price: 300, validity: "1 Month" },
                { id: 2, name: "1GB", price: 600, validity: "1 Month" },
                { id: 3, name: "2GB", price: 1200, validity: "1 Month" },
                { id: 4, name: "3GB", price: 1800, validity: "1 Month" },
                { id: 6, name: "10GB", price: 6000, validity: "1 Month" },
            ],
            "COOPERATE GIFTING": [
                { id: 50, name: "500MB", price: 130, validity: "1 Month" },
                { id: 51, name: "1GB", price: 260, validity: "1 Month" },
                { id: 52, name: "2GB", price: 520, validity: "1 Month" },
                { id: 53, name: "3GB", price: 780, validity: "1 Month" },
                { id: 54, name: "5GB", price: 1300, validity: "1 Month" },
                { id: 55, name: "10GB", price: 2600, validity: "1 Month" },
            ],
            "GIFTING": [
                { id: 101, name: "1GB", price: 400, validity: "1Day Awoof Data" },
                { id: 102, name: "1.5GB", price: 500, validity: "1Day Awoof Data" },
                { id: 103, name: "3.2GB", price: 1200, validity: "2Days Awoof Data" },
                { id: 104, name: "5GB", price: 1700, validity: "7Days Awoof Data" },
                { id: 105, name: "15GB", price: 3700, validity: "1Month Awoof Data" },
            ]
        },
        "GLO": {
            "COOPERATE GIFTING": [
                { id: 57, name: "200MB", price: 100, validity: "1 Month" },
                { id: 58, name: "500MB", price: 215, validity: "1 Month" },
                { id: 59, name: "1GB", price: 430, validity: "1 Month" },
                { id: 60, name: "2GB", price: 860, validity: "1 Month" },
                { id: 61, name: "3GB", price: 1290, validity: "1 Month" },
                { id: 62, name: "5GB", price: 2150, validity: "1 Month" },
                { id: 63, name: "10GB", price: 4300, validity: "1 Month" },
            ],
            "GIFTING": [
                { id: 90, name: "1GB", price: 230, validity: "1Day Awoof Data" },
                { id: 91, name: "2GB", price: 350, validity: "1Day Awoof Data" },
                { id: 92, name: "3.5GB", price: 550, validity: "2Days Awoof Data" },
                { id: 93, name: "15GB", price: 2300, validity: "7Days Awoof Data" },
            ]
        },
        "AIRTEL": {
            "COOPERATE GIFTING": [
                { id: 46, name: "500MB", price: 300, validity: "1 Month" },
                { id: 47, name: "1GB", price: 600, validity: "1 Month" },
                { id: 48, name: "2GB", price: 1200, validity: "1 Month" },
                { id: 49, name: "5GB", price: 3000, validity: "1 Month" },
                { id: 56, name: "10GB", price: 6000, validity: "1 Month" },
                { id: 70, name: "300MB", price: 220, validity: "1Month" },
                { id: 71, name: "100MB", price: 80, validity: "1Month" },
            ],
            "GIFTING": [
                { id: 83, name: "300MB", price: 200, validity: "2Days Awoof Data" },
                { id: 84, name: "1GB", price: 350, validity: "2Days Awoof Data" },
                { id: 85, name: "2GB", price: 450, validity: "2Days Awoof Data" },
                { id: 86, name: "3GB", price: 700, validity: "7Days Awoof Data" },
                { id: 87, name: "4GB", price: 1200, validity: "1Month Awoof Data" },
                { id: 88, name: "10GB", price: 2200, validity: "1Month Awoof Data" },
                { id: 89, name: "15GB", price: 3100, validity: "1Month Awoof Data" },
            ],
            "SME": [
                { id: 94, name: "500MB", price: 230, validity: "14 Days" },
                { id: 95, name: "1GB", price: 350, validity: "7Days" },
                { id: 96, name: "1.5GB", price: 450, validity: "7 Days" },
                { id: 97, name: "2GB", price: 650, validity: "14 Days" },
                { id: 98, name: "5GB", price: 1400, validity: "14 Days" },
                { id: 100, name: "20GB", price: 4200, validity: "30 Days" },
            ]
        },
        "9MOBILE": {
            "GIFTING": [
                { id: 36, name: "1.5GB", price: 950, validity: "1 Month" },
                { id: 37, name: "2GB", price: 1100, validity: "1 Month" },
                { id: 38, name: "3GB", price: 1400, validity: "1 Month" },
                { id: 39, name: "4.5GB", price: 1800, validity: "1 Month" },
            ],
            "COOPERATE GIFTING": [
                { id: 72, name: "500MB", price: 100, validity: "1Month" },
                { id: 73, name: "1GB", price: 200, validity: "1Month" },
                { id: 74, name: "2GB", price: 400, validity: "1Month" },
                { id: 75, name: "3GB", price: 600, validity: "1Month" },
                { id: 76, name: "5GB", price: 1000, validity: "1Month" },
                { id: 77, name: "10GB", price: 2000, validity: "1Month" },
            ]
        }
    };

    // DOM elements
    const networkSlider = document.getElementById('networkSlider');
    const sliderIndicators = document.getElementById('sliderIndicators');
    const networkOptions = document.querySelectorAll('.network-option');
    const selectedNetworkInput = document.getElementById('selectedNetwork');
    const planTypeSelect = document.getElementById('planType');
    const dataPlanSelect = document.getElementById('dataPlan');
    const phoneNumberInput = document.getElementById('phoneNumber');
    const submitButton = document.getElementById('submitButton');
    const buttonText = document.getElementById('buttonText');
    const dataForm = document.getElementById('dataForm');
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');
    const toastIcon = document.getElementById('toastIcon');
    const modalOverlay = document.getElementById('modalOverlay');
    const modalBody = document.getElementById('modalBody');
    const confirmPurchaseBtn = document.getElementById('confirmPurchase');
    const cancelPurchaseBtn = document.getElementById('cancelPurchase');

    // State variables
    let selectedNetwork = '';
    let selectedNetworkId = null;
    let selectedPlanType = '';
    let selectedDataPlan = null;
    let activeSlideIndex = 0;
    let isLoading = false;
    let startX, startScrollLeft;
    let isDown = false;

    // Initialize slider
    function initSlider() {
        // Set up mouse events for desktop
        networkSlider.addEventListener('mousedown', (e) => {
            isDown = true;
            networkSlider.classList.add('active');
            startX = e.pageX - networkSlider.offsetLeft;
            startScrollLeft = networkSlider.scrollLeft;
            e.preventDefault();
        });

        networkSlider.addEventListener('mouseleave', () => {
            isDown = false;
            networkSlider.classList.remove('active');
        });

        networkSlider.addEventListener('mouseup', () => {
            isDown = false;
            networkSlider.classList.remove('active');
            snapToClosestSlide();
        });

        networkSlider.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - networkSlider.offsetLeft;
            const walk = (x - startX) * 2; // Scroll speed multiplier
            networkSlider.scrollLeft = startScrollLeft - walk;
        });

        // Set up touch events for mobile
        networkSlider.addEventListener('touchstart', (e) => {
            isDown = true;
            networkSlider.classList.add('active');
            startX = e.touches[0].pageX - networkSlider.offsetLeft;
            startScrollLeft = networkSlider.scrollLeft;
        }, { passive: true });

        networkSlider.addEventListener('touchend', () => {
            isDown = false;
            networkSlider.classList.remove('active');
            snapToClosestSlide();
        });

        networkSlider.addEventListener('touchmove', (e) => {
            if (!isDown) return;
            const x = e.touches[0].pageX - networkSlider.offsetLeft;
            const walk = (x - startX) * 2;
            networkSlider.scrollLeft = startScrollLeft - walk;
        }, { passive: true });

        // Set up scroll event to update active slide
        networkSlider.addEventListener('scroll', handleSliderScroll);
        
        // Set up indicator clicks
        const indicators = document.querySelectorAll('.indicator');
        indicators.forEach(indicator => {
            indicator.addEventListener('click', () => {
                const index = parseInt(indicator.dataset.index);
                scrollToSlide(index);
            });
        });
        
        // Set up network option clicks
        networkOptions.forEach((option, index) => {
            option.addEventListener('click', (e) => {
                if (Math.abs(networkSlider.scrollLeft - (index * networkSlider.offsetWidth)) < 50) {
                    const network = option.dataset.network;
                    const networkId = parseInt(option.dataset.networkId);
                    selectNetwork(network, networkId, option);
                }
            });
        });

        // Initialize with the first network selected
        const firstOption = networkOptions[0];
        selectNetwork(
            firstOption.dataset.network,
            parseInt(firstOption.dataset.networkId),
            firstOption
        );
    }

    function snapToClosestSlide() {
        const slideWidth = networkSlider.offsetWidth;
        const slideIndex = Math.round(networkSlider.scrollLeft / slideWidth);
        scrollToSlide(slideIndex);
    }

    // Handle slider scroll
    function handleSliderScroll() {
        const slideWidth = networkSlider.offsetWidth;
        const newActiveSlide = Math.round(networkSlider.scrollLeft / slideWidth);
        
        if (newActiveSlide !== activeSlideIndex && newActiveSlide >= 0 && newActiveSlide < networkOptions.length) {
            activeSlideIndex = newActiveSlide;
            updateIndicators();
            
            // Select the network at the current slide
            const activeOption = networkOptions[activeSlideIndex];
            const network = activeOption.dataset.network;
            const networkId = parseInt(activeOption.dataset.networkId);
            selectNetwork(network, networkId, activeOption);
        }
    }

    // Update slider indicators
    function updateIndicators() {
        const indicators = document.querySelectorAll('.indicator');
        indicators.forEach((indicator, index) => {
            if (index === activeSlideIndex) {
                indicator.classList.add('active');
            } else {
                indicator.classList.remove('active');
            }
        });
    }

    // Scroll to specific slide
    function scrollToSlide(index) {
        if (index < 0) index = 0;
        if (index >= networkOptions.length) index = networkOptions.length - 1;
        
        const slideWidth = networkSlider.offsetWidth;
        networkSlider.scrollTo({
            left: slideWidth * index,
            behavior: 'smooth'
        });
    }

    // Select network
    function selectNetwork(network, networkId, element) {
        // Reset previous selection
        networkOptions.forEach(opt => opt.classList.remove('selected'));
        
        // Set new selection
        element.classList.add('selected');
        selectedNetwork = network;
        selectedNetworkId = networkId;
        selectedNetworkInput.value = network;
        
        // Update plan types
        updatePlanTypes();
        
        // Reset other fields
        resetDataPlanAndSummary();
        
        // Update button state
        updateSubmitButtonState();
    }

    // Update plan types based on selected network
    function updatePlanTypes() {
        // Clear existing options
        planTypeSelect.innerHTML = '<option value="" disabled selected>Select Plan Type</option>';
        
        if (selectedNetwork) {
            const planTypes = Object.keys(DATA_PLANS[selectedNetwork] || {});
            
            planTypes.forEach(type => {
                const option = document.createElement('option');
                option.value = type;
                option.textContent = type;
                planTypeSelect.appendChild(option);
            });
            
            planTypeSelect.disabled = planTypes.length === 0;
        } else {
            planTypeSelect.disabled = true;
        }
    }

    // Reset data plan and summary
    function resetDataPlanAndSummary() {
        selectedPlanType = '';
        selectedDataPlan = null;
        planTypeSelect.value = '';
        dataPlanSelect.innerHTML = '<option value="" disabled selected>Select Data Plan</option>';
        dataPlanSelect.disabled = true;
    }

    // Update data plans based on selected plan type
    function updateDataPlans() {
        // Clear existing options
        dataPlanSelect.innerHTML = '<option value="" disabled selected>Select Data Plan</option>';
        
        if (selectedNetwork && selectedPlanType) {
            const dataPlans = DATA_PLANS[selectedNetwork][selectedPlanType] || [];
            
            dataPlans.forEach(plan => {
                if (plan.id && plan.name) { // Check for valid plan data
                    const option = document.createElement('option');
                    option.value = plan.id;
                    option.textContent = `${plan.name} - ${formatCurrency(plan.price)} - ${plan.validity}`;
                    dataPlanSelect.appendChild(option);
                }
            });
            
            dataPlanSelect.disabled = dataPlans.length === 0;
        } else {
            dataPlanSelect.disabled = true;
        }
    }

    // Format currency
    function formatCurrency(amount) {
        return new Intl.NumberFormat('en-NG', { 
            style: 'currency', 
            currency: 'NGN',
            minimumFractionDigits: 0,
            maximumFractionDigits: 0
        }).format(amount);
    }

    // Update submit button state
    function updateSubmitButtonState() {
        const isFormValid = 
            selectedNetwork && 
            selectedPlanType && 
            selectedDataPlan && 
            phoneNumberInput.value.length === 11 && 
            /^\d+$/.test(phoneNumberInput.value) &&
            !isLoading;
        
        submitButton.disabled = !isFormValid;
    }

    // Set loading state
    function setLoading(loading) {
        isLoading = loading;
        
        if (loading) {
            buttonText.innerHTML = '<span class="loading"></span>Processing...';
        } else {
            buttonText.innerHTML = 'Buy Now';
        }
        
        submitButton.disabled = loading;
    }

    // Show toast notification
    function showToast(message, isError = false) {
        toastMessage.textContent = message;
        toast.className = isError ? 'toast error' : 'toast success';
        
        // Set icon based on type
        if (isError) {
            toastIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                    <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
            `;
        } else {
            toastIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
            `;
        }
        
        // Show toast
        toast.classList.add('show');
        
        // Hide toast after 3 seconds
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }

    // Show modal
    function showModal() {
        modalOverlay.classList.add('active');
    }

    // Hide modal
    function hideModal() {
        modalOverlay.classList.remove('active');
    }

    // Event listeners
    planTypeSelect.addEventListener('change', function() {
        selectedPlanType = this.value;
        selectedDataPlan = null;
        updateDataPlans();
        updateSubmitButtonState();
    });

    dataPlanSelect.addEventListener('change', function() {
        const planId = parseInt(this.value);
        
        if (selectedNetwork && selectedPlanType) {
            const dataPlans = DATA_PLANS[selectedNetwork][selectedPlanType] || [];
            selectedDataPlan = dataPlans.find(plan => plan.id === planId) || null;
        }
        
        updateSubmitButtonState();
    });

    phoneNumberInput.addEventListener('input', function() {
        // Allow only digits
        this.value = this.value.replace(/\D/g, '');
        updateSubmitButtonState();
    });

    dataForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (!selectedNetwork || !selectedPlanType || !selectedDataPlan || phoneNumberInput.value.length !== 11) {
            showToast('Please fill in all required fields correctly', true);
            return;
        }

        // Prepare modal content
        modalBody.innerHTML = `
            <p>Are you sure you want to buy ${selectedDataPlan.name} data for ${phoneNumberInput.value}?</p>
            <div class="summary-row">
                <span class="summary-label">Network:</span>
                <span class="summary-value">${selectedNetwork}</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Plan:</span>
                <span class="summary-value">${selectedDataPlan.name}</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Validity:</span>
                <span class="summary-value">${selectedDataPlan.validity}</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Phone Number:</span>
                <span class="summary-value">${phoneNumberInput.value}</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">Price:</span>
                <span class="summary-value">${formatCurrency(selectedDataPlan.price)}</span>
            </div>
        `;

        // Show modal
        showModal();
    });

    // Confirm purchase
    confirmPurchaseBtn.addEventListener('click', async function() {
        hideModal();
        setLoading(true);

        try {
            // Generate a unique request ID
            const requestId = `Data_${Date.now()}${Math.floor(Math.random() * 1000)}`;

            // Prepare the request payload
            const payload = {
                network: selectedNetworkId,
                phone: phoneNumberInput.value,
                data_plan: selectedDataPlan.id,
                bypass: false,
                "request-id": requestId
            };

            console.log("Sending request payload:", payload);

            // Make the API call
            const response = await fetch('https://n3tdata.com/api/data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Token ${ACCESS_TOKEN}`
                },
                body: JSON.stringify(payload)
            });
            
            const responseData = await response.json();
            console.log("API Response:", responseData);
            
            if (responseData.status === 'success') {
                showToast(`${selectedDataPlan.name} data bundle has been purchased for ${phoneNumberInput.value}`);
            } else {
                showToast(responseData.message || 'There was an error processing your request.', true);
            }
        } catch (error) {
            console.error("Error purchasing data:", error);
            showToast('Network error or server is unreachable. Please try again.', true);
        } finally {
            setLoading(false);
        }
    });

    // Cancel purchase
    cancelPurchaseBtn.addEventListener('click', function() {
        hideModal();
    });

    // Initialize the page
    initSlider();
</script>
</body>
</html>